# 前端策略選項修復說明

## 問題發現

您說得很對！我在後端添加了`rcts_hierarchical`和`structured_hierarchical`策略，但前端沒有顯示這些選項。

### 問題原因

前端的策略選擇是基於`strategyInfo`對象，但這個對象中沒有包含新增的兩個策略：

- `rcts_hierarchical` - RCTS 層次分割
- `structured_hierarchical` - 結構化層次分割

## 修復內容

### 1. 添加 RCTS 層次分割策略

```typescript
rcts_hierarchical: {
  name: "RCTS層次分割",
  description: "結合RecursiveCharacterTextSplitter和層次結構識別，智能分割法律文檔。",
  metrics: ["分隔符準確性", "結構保持度", "長文本處理", "語義完整性"],
  params: {
    max_chunk_size: {
      label: "最大分塊大小",
      min: 200,
      max: 2000,
      default: 1000,
      unit: "字符",
    },
    overlap_ratio: {
      label: "重疊比例",
      min: 0.05,
      max: 0.3,
      default: 0.1,
      unit: "比例",
    },
    preserve_structure: {
      label: "保持層次結構",
      type: "boolean",
      default: true,
      description: "在條文邊界強制分割，確保法律邏輯完整性",
    },
  },
},
```

### 2. 添加結構化層次分割策略

```typescript
structured_hierarchical: {
  name: "結構化層次分割",
  description: "基於JSON結構數據，按照法律文檔的章-節-條-項結構進行智能分割。",
  metrics: ["結構準確性", "條文完整性", "引用關係保持", "分割粒度"],
  params: {
    max_chunk_size: {
      label: "最大分塊大小",
      min: 200,
      max: 2000,
      default: 1000,
      unit: "字符",
    },
    overlap_ratio: {
      label: "重疊比例",
      min: 0.05,
      max: 0.3,
      default: 0.1,
      unit: "比例",
    },
    chunk_by: {
      label: "分割單位",
      type: "select",
      options: [
        { value: "article", label: "按條文分割" },
        { value: "item", label: "按項分割" },
        { value: "section", label: "按節分割" },
        { value: "chapter", label: "按章分割" },
      ],
      default: "article",
      description: "選擇分割的粒度級別",
    },
  },
},
```

## 現在可用的策略

### 1. 固定大小分割

- 將文檔按照固定的字符數進行分割
- 適合結構化文檔

### 2. 層次分割

- 根據文檔結構（標題、段落等）進行層次化分割
- 保持語義完整性

### 3. RCTS 層次分割 ⭐ **新增**

- 結合 RecursiveCharacterTextSplitter 和層次結構識別
- 智能分割法律文檔
- 支持保持層次結構選項

### 4. 結構化層次分割 ⭐ **新增**

- 基於 JSON 結構數據
- 按照法律文檔的章-節-條-項結構進行智能分割
- 支持多種分割粒度（條文、項、節、章）

### 5. 自適應分割

- 根據內容語義自動調整分塊大小
- 平衡長度和語義完整性

### 6. 混合分割

- 結合多種策略，根據內容特徵動態選擇最適合的分割方法

### 7. 語義分割

- 基於語義相似度進行分割
- 保持語義連貫性

## 測試建議

現在您可以測試以下策略組合：

### 1. 基本對比測試

- **固定大小分割** vs **RCTS 層次分割**
- **層次分割** vs **RCTS 層次分割**
- **RCTS 層次分割** vs **結構化層次分割**

### 2. 結構化層次分割細分測試

- 按條文分割 vs 按項分割
- 按節分割 vs 按章分割
- 觀察不同粒度的效果差異

### 3. RCTS 層次分割選項測試

- 保持層次結構：開 vs 關
- 不同重疊比例的效果
- 不同最大分塊大小的影響

## 預期效果

### 1. RCTS 層次分割

- 更智能的分割點選擇
- 更好的語義完整性
- 處理長文本更優雅

### 2. 結構化層次分割

- 精確的結構識別
- 保持法律邏輯
- 支持條文引用關係

### 3. 評測結果差異

- 不同策略應該產生不同的評測指標
- 推薦配置應該反映策略特性
- 結果表格應該顯示策略信息

## 總結

修復完成！現在前端會顯示所有 7 個分割策略選項：

✅ **固定大小分割**
✅ **層次分割**  
✅ **RCTS 層次分割** ⭐
✅ **結構化層次分割** ⭐
✅ **自適應分割**
✅ **混合分割**
✅ **語義分割**

您可以現在測試這些策略，特別是新增的 RCTS 層次分割和結構化層次分割，應該能看到顯著的改進效果！
